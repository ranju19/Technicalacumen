<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=0.1" />

  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/all.min.css"/>

  <title>AI RESOURCE HUB</title>


  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;500&family=DM+Serif+Text&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Philosopher&display=swap" rel="stylesheet">
  <!--link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"-->

</head>

<body>
    <nav class="navbar">
      <div class="nav-left-group">

        <span id="burger-icon" onclick="toggleSidebar()">â˜°</span>

        <a href="index.html" class="nav-left">Technicalacumen</a>
      </div>
      <div class="nav-right">
      <div class="search-container">
        <input type="text" class="search-input" placeholder="Feed Your Curiosity...">

      </div>
        <a href="index.html">HOME</a>
        <a href="chatroom.html">CHATROOM</a>
        <a href="#contact">CONTACT</a>
        <a href="login.html">LOGIN</a>
      </div>

    </nav>

  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h2>Dashboard</h2>
    </div>
    <ul>
     <li><a>Calender</a></li>
     <li><a href="blog.html">Blogs</a></li>
     <li><a href="industrynews.html">Industry News</a></li>
     <li><a href="podcast.html">Podcast</a></li>
     <li><a>Activity</a></li>
     <li><a>Leaderboard</a></li>
     <li><a href="feedback.html">Feedback</a></li>
    </ul>
  </div>


  <div class="chat-container">
    <h1>ðŸ’¬ Thread Chatroom</h1>
    <div class="input-area">
      <textarea id="messageInput" placeholder="What's on your mind?"></textarea>
      <button onclick="sendMessage()">Post</button>
    </div>
    <div id="chatThread"></div>
  </div>


<!-- Floating Chat Button -->
  <!-- CHAT BUTTON -->
  <div id="chat-button" onclick="toggleChat()">ðŸ’¬</div>
    <i class="fas fa-comment-dots"></i>
  <!-- CHAT BOX -->
  <div id="chat-box">
    <div class="chat-header">
      <span>Welcome to Live Chat!</span>
      <span onclick="closeChat()">âœ–</span>
    </div>
    <div id="chat-content" class="chat-content"></div>
    <div class="chat-input">
      <textarea placeholder="Type here..."></textarea>
      <button onclick="postMessage()">âž¤</button>
    </div>
  </div>
  </div>


  <footer>
    <p>&copy; 2025 AI Resources Hub . Built by INH</p>
  </footer>


  <!-- Firebase -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import {
  getFirestore,
  collection,
  addDoc,
  query,
  onSnapshot,
  orderBy,
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";


 const firebaseConfig = {
    apiKey: "AIzaSyDUsFY_MZpSEER_AKZbW1Bsmynlr7MtmR4",
    authDomain: "threadchat-82e4e.firebaseapp.com",
    projectId: "threadchat-82e4e",
    storageBucket: "threadchat-82e4e.firebasestorage.app",
    messagingSenderId: "936732463790",
    appId: "1:936732463790:web:4df64af0ee5594cb35d33f",
    measurementId: "G-R06YNDQH2M"
  };

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const messagesRef = collection(db, "messages");


window.sendMessage = async function(parentId = null, replyText = null) {
  const input = replyText ?? document.getElementById("messageInput").value;
  if (!input.trim()) return;

  await addDoc(messagesRef, {
    text: input,
    parent: parentId,
    timestamp: new Date()
  });
  if (!replyText) document.getElementById("messageInput").value = "";
};


function renderThread(messages, parentId = null, level = 0) {
  return messages
    .filter(msg => msg.data.parent === parentId)
    .map(msg => {
      const replies = renderThread(messages, msg.id, level + 1);
      return `
        <div class="thread-message" style="margin-left: ${level * 20}px">
          <p>${msg.data.text}</p>
          <button class="reply-button" onclick="showReplyBox('${msg.id}')">â†ª Reply</button>
          <div id="reply-${msg.id}" class="reply-input"></div>
          ${replies.join("")}
        </div>
      `;
    });
}


onSnapshot(query(messagesRef, orderBy("timestamp")), snapshot => {
  const allMessages = snapshot.docs.map(doc => ({
    id: doc.id,
    data: doc.data()
  }));

  const threadHTML = renderThread(allMessages).join("");
  document.getElementById("chatThread").innerHTML = threadHTML;
});

window.showReplyBox = function (msgId) {
  const replyDiv = document.getElementById(`reply-${msgId}`);
  replyDiv.innerHTML = `
    <textarea placeholder="Reply..."></textarea>
    <button onclick="sendMessage('${msgId}', this.previousElementSibling.value)">Post Reply</button>
  `;
};
</script>



</body>
</html>
